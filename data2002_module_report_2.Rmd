---
title: "Data2002 Module Report 2"
author: '470518795 480050719'
date: "20/09/2019"
output:
  html_document:
    code_folding: hide
    css: https://use.fontawesome.com/releases/v5.2.0/css/all.css
    fig_caption: yes
    number_sections: no
    self_contained: yes
    theme: flatly
    toc: yes
    toc_depth: 2
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '2'
---

```{r setup, include=FALSE,warning=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library("tidyverse")
library("lubridate")
library("kableExtra")
library("forcats")
library("readr")
library("dplyr")
library("janitor")
library("ggplot2")
remotes::install_github("ropenscilabs/gendercodeR",force = TRUE)
library("gendercodeR")
```

<style>
h1.title {
  font-size: 44px;
}
blockquote {
    border-left:none;
    font-size: 1em;
    display: block;
    margin-top: .25em;
    margin-left: 20px;
}
.table{
    margin-bottom:0px;
}
h1 {
    color:	#e64626;
    font-size: 32px;
}
h2 {
    font-size: 22px;
}
h3 {
    font-size: 21px;
}
h4 {
    font-size: 17px;
}
.list-group-item.active, .list-group-item.active:hover, .list-group-item.active:focus{
    background-color:#e64626;
}
h2, h3, h4, h5, h6 {
    color: black;
}
h1, h2, h3{
font-weight:bold;
}
a { 
    color: #0148A4; 
} 
body { 
    color: #424242; 
}
</style>

# Introduction
The survey conducted by Dr.Garth is about the different characteristics as well as social and academic activities of student enrolled in data20X2 in 2019 semester 2 at University of Sydney. The data from this survey is collected from 110 enrolled students.


# Importing data
```{r import data,message=FALSE}
mydata=readr::read_csv("data/DATA2X02 class survey.csv",na=c(""," "))
```

# Data cleaning
```{r}
clean_data<-janitor::clean_names(mydata)
# Using the function to clean the column names
# however, there are some columns which are quite long, it can be cleaned further.
new_colnames<-c("survey_time","user_name","gender","home_postcode","previous_statistics_courses",
                "number_of_clubs_attended","last_time_went_to_dentist","study_time","social_media",
                "number_of_siblings","pet","live_with_parents","hours_of_exercise_per_week","eye_color","work_time","favourite_season","shoe_size","height","frequency_of_floss_teeth","with_glasses","dominant_hand","steak_cooked_preference")
colnames(mydata)<-new_colnames
colnames(mydata)
```

## Eye color
```{r warning=FALSE,message=FALSE}
mydata=mydata %>% mutate(eye_color=stringr::str_to_title(eye_color),
                         eye_color=case_when(eye_color=="Balack"~"Black",eye_color=="Hazelnut"~"Hazel",TRUE~eye_color))
mydata = mydata %>% 
  mutate(
    eye_color = forcats::fct_lump_min(eye_color, min = 2)
  )
mydata %>% ggplot(aes(x = eye_color)) + geom_bar(fill = c("black", 
    "blue", "brown2", "brown4", "green3", "darkgoldenrod3", "red")) + 
    labs(title = "eye_color", y = "Count", 
        x = "Eye color") + theme_linedraw() + coord_flip()
mydata %>% tabyl(eye_color) %>% adorn_pct_formatting() %>% kable()

```

## Gender
```{r}
recoded_gender=recode_gender(gender=mydata$gender)
mydata$gender=recoded_gender
mydata %>% tabyl(gender)%>% adorn_pct_formatting()%>%kable()
```

## Social media
```{r}
mydata$social_media=mydata$social_media %>% tolower()
mydata$social_media=forcats::fct_recode(mydata$social_media,
                                        "facebook"="facebook messenger",
                                        "facebook"="fb",
                                        "instagram"="ig",
                                        "none"="i never use social media.")
mydata$social_media=forcats::fct_lump(mydata$social_media,n=7) 
mydata %>% tabyl(social_media) %>% adorn_pct_formatting()%>%kable()
```


## Height
```{r}
mydata = mydata %>% mutate(
  height =case_when(
    height<2.2 ~ height*100,
    height<4 ~ NA_real_,
    height<8 ~height *30.48,
    height>250 ~NA_real_,
    TRUE ~ height)
) %>%drop_na()
hist(mydata$height,main="Distribution of height",xlab = "Height in cm",col = "yellow")
```

## Exercise
```{r}
mydata$hours_of_exercise_per_week<-as.numeric(mydata$hours_of_exercise_per_week)
mydata=mydata %>%mutate(
  hours_of_exercise_per_week=case_when(
    hours_of_exercise_per_week>60 ~ NA_real_,
    TRUE ~ hours_of_exercise_per_week
  )
)
mydata$hours_of_exercise_per_week=as.numeric(mydata$hours_of_exercise_per_week)
```

## clubs
```{r}
mydata$number_of_clubs_attended=as.double(mydata$number_of_clubs_attended)
mydata = mydata %>%
  mutate(number_of_clubs_attended=case_when(
    number_of_clubs_attended<0 ~ NA_real_,
    number_of_clubs_attended>10 ~ NA_real_,
    TRUE ~ number_of_clubs_attended
  )) %>% drop_na
mydata %>% tabyl(number_of_clubs_attended) %>% adorn_pct_formatting()%>%kable()
```

## Study
```{r}
study <-mydata %>% select(live_with_parents,study_time) %>% filter(study_time<70)
with_parents<- study %>%
  filter(live_with_parents=="Yes")
without_parents <-study %>%
  filter(live_with_parents=="No")
study %>% ggplot(aes(x=live_with_parents,y=study_time)) +
  geom_boxplot()+
  theme_light()+
  labs(x="live with parents",y="study time(hrs)",title = "study time for students live or not with their parents", caption = "Data2X02 survey")
```


## Save the cleaned data
```{r}
readr::write_csv(mydata,"mydata_cleaned.csv")
```


# Data analysis
## 1: Is this a random sample of DATA2002 students?

This survey is not random sample.  Students who completed this survey is actively interact with lecturer, however, not all response to this survey. Therefore, samples only can represent a part of active DATA2X02 students, it cannot represent the whole population. This survey suffers from selection bias. Those who do not respond survey is inactive comparing with those who complete it, certain group(inactive students) are under-represented. The probability of completing survey is not the same across the students, therefore the sample is not random. 


## 2: What are the potential biases in this data generation?

There might be selection bias, people answering this survey is likely to be more active. Some inactive students do not answer the survey. Therefore, the sample does not acurately represents the population.

There also likely to exists measurement bias. For example, if it is hard to identify whether student studying 30 hours per week or 30 min if he just type 30 in the survey. Also , there are some people who study more than 144 hours one week, which is unrealistic. This is because some people does not take this survey seriously. Therefore, there exists measurement bias in the dataset.

Another measurement bias would be on study time, student may tend to overestimate their study time since they may feel inappropriate to study less than certain amount of time. Since we can not detect the truth and there is no penalty or award for eliciting the real time of study. Therefore, this is not incentive compatible.

## 3: Which variables are most likely to be subjected to this bias?

In this survey, there are several biases, and the free-response variables are most likely to be subjected to this bias because the answers of these questions often have unrelated or even impossible answers, such as exercise time, study time. For example, it is impossible for a person to study more than 144 hours per week. These kind of response of those variables could even be outliers there, which would definitely lead to bias in this survey.

Besides, the variable that did not clarify the standard measurement units are also most likely to be subjected to this bias, such as height(it could be measured in cm or m), study hours(it could be measured in minutes or hours), shoe size (it is different in different country). For example, the height, someone use cm as measurement unit (for example, 178) and someone use m as measurement unit here (for example, 1.89).

## 4: Is there any evidence to suggest that there’s a difference in the amount of exercise done by people who eat red meat compared to people who don’t eat red meat?

### Visualisation
```{r warning=FALSE}
mydata$steak_cooked_preference=fct_collapse(mydata$steak_cooked_preference,
                                            eaters=c("Blue","Rare","Medium-rare","Medium","Medium-well done","Well done"),
                                            non_eaters=c("I don't eat red meat"))
exercise = mydata %>% filter(steak_cooked_preference=="eaters"||steak_cooked_preference=="non-eaters")%>% select(steak_cooked_preference,hours_of_exercise_per_week)

ggplot(subset(exercise,!is.na(steak_cooked_preference)),aes(x=steak_cooked_preference,y=hours_of_exercise_per_week))+
  geom_boxplot()+
  theme(
    legend.position = "none",
    plot.title = element_text(size = 11)
  )+
  geom_jitter(color="blue",size=0.9,alpha=0.9)+
  labs(title = "The hours of exercise per week for red meat eaters and non-eaters",
       x="Red meat eater?",
       y="Hours exercise per week",
       caption = "Source: DATA2X02 survey")

```

### Two sample test
This is a two sample test.

**Check for assumption: Equal Variance**

Firstly, looking at the pooled two sample t-test, the assumption here is there have equal variance. By calculation, it can be seen that the standard deviation differences among the sample is approximately 1. By test of equal variance assumption, p-value is much more than 0.05. Therefore, we have sufficient evidence to assume equal variance.
```{r Check for equal variance assumption}
eaters=exercise %>% filter(steak_cooked_preference=="eaters",as.numeric(hours_of_exercise_per_week)) %>% drop_na
sd_eaters=sd(eaters$hours_of_exercise_per_week)
non_eaters=exercise %>% filter(steak_cooked_preference=="non_eaters",as.numeric(hours_of_exercise_per_week)) %>% drop_na
sd_noneaters=sd(non_eaters$hours_of_exercise_per_week)
c((sd_eaters),(sd_noneaters))
var.test(eaters$hours_of_exercise_per_week,non_eaters$hours_of_exercise_per_week)
```

**Check for assumption: Normality**

Secondly, it is assumed that the distribution of these data is normal. This assumption cen be checked by drawing QQ-plot to see wehther it is approximate straight line. By looking at two diagram, it is obvious that the sample is quite fit with theoretical line. The problem is that we have only few samples of non-eaters. Therefore, it is reasonable to assume hours of exercise is normally distributed.

```{r}
par(mfrow=c(1,2))
qqnorm(eaters$hours_of_exercise_per_week,main="Eaters Normal Q-Q Plot",xlab="Theoretical quantiles",ylab="Sample Quantiles")
qqline(eaters$hours_of_exercise_per_week)
qqnorm(non_eaters$hours_of_exercise_per_week,main="Non-eaters Normal Q-Q Plot",xlab="Theoretical quantiles",ylab="Sample Quantiles")
qqline(non_eaters$hours_of_exercise_per_week)
```

It is suggested that the pooled two sample t-test should be used in this analysis since the equal variance assumption is statisfied.

### Pooled two sample t-test

**Hypothesis**
 $H_0: u_{eaters} = p_{non-eaters}$ vs  $H_1: u_{eaters}\neq u_{non-eaters}$
 Null hypothesis: There is no difference in hours of exercise per week between red meat eaters and non-eaters
 Alternative: The hours of exercise between these two groups are different.

**Assumption**
 $X_1, ..., X_{n_x}$ are iid with $N(\mu_X,\sigma^2)$, $Y_1, ..., Y_{n_x}$ are iid with $N(\mu_Y,\sigma^2)$ and $X_i$ are independent of $Y_i$

**Test statistics**
 $T=\frac{\bar{X} - \bar{Y}}{S_p\sqrt{\frac{1}{n_x} + \frac{1}{n_y}}}$, where $S_p^2=\frac{(n_x-1)S_{x}^2+(n_y-1)S_{y}^2}{n_x+n_y-2}$. Under $H_0$, $T\sim t_{n_x+n_y-2}$

**Observed test statistics**
 $t_0=0.4073664$
 
```{r}
n1=nrow(eaters)
n2=nrow(non_eaters)
Sp=sqrt(((n1-1)*(sd_eaters)^2+(n2-1)*(sd_noneaters)^2)/(n1+n2-2))
t_0=(mean(eaters$hours_of_exercise_per_week)-mean(non_eaters$hours_of_exercise_per_week))/(Sp*sqrt(1/n1+1/n2))
t_0
```


**P-value**
 $p=2P(T\geq t_0) = 0.6850$ 
 
```{r}
(p=2*pt(t_0,df=n1+n2-2,lower.tail = FALSE))
```


**Decision**
 Since the p-value is approximately 0.68, this is not significant at 5% significance level, therefore, we do not reject null hypthothesis that there is no difference on    hours of exercise per week between red meat eaters and non-eaters.


```{r}
t.test(eaters$hours_of_exercise_per_week,non_eaters$hours_of_exercise_per_week,alternative="two.sided",var.equal = TRUE)
```

As mentioned, the only concern is that for non-eaters, there are only few samples. It is doubt that the normality assumption is hold. To make our analysis more robust, we can use Wilcoxon rank-sum test which relaxes on normality assumption.

### Wilcoxon rank-sum test

**Hypothesis**
$H_0: \mu_x = \mu_y$ vs $H_1: \mu_x \neq \mu_y$

**Assumption**
$X_1, ..., X_{n_x}$ and $Y_1, ..., Y_{n_x}$ are iid and follow the same distribution but differ by a shift.

**Test statistics**
$W = R_1+R_2+...+R_{n_x}$. Under $H_0$, $W \sim WRS(100, 7)$ distribution

**Observed test statistics**
$w=r_1+r_2+...+r_n_x=175$

**P-value**
$E(W)=\frac{100(107+1)}{2}=5400$

$Var(W)=\frac{100*7}{107(107-1)}(\sum_{i=1}^{N}(r^2_i)-\frac{107(107+1)^2}{4})$

$p\approx 2P(Z\geq |\frac{W-E(W)}{\sqrt{Var(W)}}|) =0.726$

**Decision**
As the p-value is much more than 0.05, there is insufficient evidence to reject $H_0$.

```{r}
wilcox.test(eaters$hours_of_exercise_per_week,non_eaters$hours_of_exercise_per_week,correct = FALSE,alternative = "two.sided")
```

### Conclusion:
In these two test, we do not have sufficient evidence to reject H0: There is no difference in weekly hours of exercise between eaters and non-eaters. Therefore, we do not reject null hypothesis and find evidence for difference in weekly exercise hours between red meat eaters and non-eaters.

## 5: Is there any evidence that the weekly exercise time of students who participate in more than 3 univeristy clubs is different to those who don’t?
```{r}
data = data.frame(mydata$number_of_clubs_attended,mydata$hours_of_exercise_per_week)
moreclub= data %>%
  filter(mydata.number_of_clubs_attended>3)
lessclub=data %>%
  filter(mydata.number_of_clubs_attended<=3)

```


### Two sample test
This is a two sample test.

**Check for assumption: Normality**

By checking the qqplot, it can be seen that the qqplot isn't fit well as well. Therefore, it is suggested that we should relax the normality assumption and use Wilcoxon rank-sum test.
```{r}
par(mfrow=c(1,2))
qqnorm(moreclub$mydata.hours_of_exercise_per_week,main="Exercise Normal Q-Q Plot",xlab="Theoretical quantiles",ylab="Sample Quantiles")
qqline(moreclub$mydata.hours_of_exercise_per_week)
qqnorm(lessclub$mydata.hours_of_exercise_per_week,main="Exercise Normal Q-Q Plot",xlab="Theoretical quantiles",ylab="Sample Quantiles")
qqline(lessclub$mydata.hours_of_exercise_per_week)
```

### Wilcoxon Ranked-sum test

We need to do is check the assumption of Wilcoxon Ranked sum test which is the 2 samples follow the same distribution. By looking at the boxplot, these two are roughly symmetric. Therefore, we can use Wilcoxon Ranked-sum test.
```{r}
data = data %>%
  mutate(number_of_clubs_attended = 
           case_when(
             mydata.number_of_clubs_attended < 3 ~ "less",
             mydata.number_of_clubs_attended >= 3 ~ "more"
           ))
ggplot(subset(data, !is.na(mydata.number_of_clubs_attended),!is.na(mydata.hours_of_exercise_per_week)), aes(x = number_of_clubs_attended, y = mydata$hours_of_exercise_per_week)) +
geom_boxplot() +
theme_bw()+
  labs(title="Distribution of exercise",
       x="Number of clubs",
       y="Weekly hour of exercise",
       caption = "Source: Data2X02 survey")
```

**Hypothesis**
$H_0: \mu_x = \mu_y$ vs $H_1: \mu_x \neq \mu_y$

**Assumption**
$X_1, ..., X_{n_x}$ and $Y_1, ..., Y_{n_x}$ are iid and follow the same distribution but differ by a shift.

**Test statistics**
$W = R_1+R_2+...+R_{n_x}$. Under $H_0$, $W \sim WRS(n_x, n_y)$ distribution

**Observed test statistics**
$w=r_1+r_2+...+r_n_x=183.5$

**P-value**

$p\approx 2P(Z\geq |\frac{W-E(W)}{\sqrt{Var(W)}}|) =0.8605$

**Decision**
As the p-value is much more than 0.05, there is insufficient evidence to reject $H_0$.

```{r}
wilcox.test(lessclub$mydata.hours_of_exercise_per_week,moreclub$mydata.hours_of_exercise_per_week,correct=FALSE,alternative = "two.sided")
```

### Conclusion
In the test, we do not have sufficient evidence to reject H0: There is no difference in weekly hours of exercise between people who attend less or more club. Therefore, we do not reject null hypothesis.

## 6: Is there evidence that students who live with their parents study more hours per week than students who don’t live with their parents?

**Checking for assumption: Equal variance**
```{r}
sd_with_parents=sd(with_parents$study_time)
sd_noparents=sd(without_parents$study_time)
c((sd_with_parents),(sd_noparents))
var.test(with_parents$study_time,without_parents$study_time)
```
It can be seen that our variance test is not being rejected, therefore, we can say that the equal variance assumption is not violated. Hence, we can use pooled two sample t-test.

**Checking for assumption: Normality**
```{r}
par(mfrow=c(1,2))
qqnorm(with_parents$study_time,main="with parents Normal Q-Q Plot",xlab="Theoretical quantiles",ylab="Sample Quantiles")
qqline(with_parents$study_time)
qqnorm(without_parents$study_time,main="without parents Normal Q-Q Plot",xlab="Theoretical quantiles",ylab="Sample Quantiles")
qqline(without_parents$study_time)
```
By looking at the QQ plot, it can be seen that the line is quite fitting to our sample quantiles. Therefore, the normality assumption is also hold. We can use pooled sample t-test and Wilcoxon test.

### Pooled two sample t-test

**Hypothesis**
 $H_0: u_{eaters} = p_{non-eaters}$ vs  $H_1: u_{eaters}\neq u_{non-eaters}$
 Null hypothesis: There is no difference in hours of study per week between those who living or not living with their parents
 Alternative: The hours of study between these two groups are different.

**Assumption**
 $X_1, ..., X_{n_x}$ are iid with $N(\mu_X,\sigma^2)$, $Y_1, ..., Y_{n_x}$ are iid with $N(\mu_Y,\sigma^2)$ and $X_i$ are independent of $Y_i$

**Test statistics**
 $T=\frac{\bar{X} - \bar{Y}}{S_p\sqrt{\frac{1}{n_x} + \frac{1}{n_y}}}$, where $S_p^2=\frac{(n_x-1)S_{x}^2+(n_y-1)S_{y}^2}{n_x+n_y-2}$. Under $H_0$, $T\sim t_{n_x+n_y-2}$

**Observed test statistics**
 $t_0=-0.26091$
 
```{r}
t.test(with_parents$study_time,without_parents$study_time,var.equal = TRUE,alternative = "two.sided")
```


**P-value**
 $p=2P(T\geq t_0) = 0.7949$ 
 


**Decision**
 Since the p-value is approximately 0.79, this is not significant at 5% significance level, therefore, we do not reject null hypthothesis that there is no difference on    hours of study per week between these two groups.



As mentioned, the only concern is that for non-eaters, there are only few samples. It is doubt that the normality assumption is hold. To make our analysis more robust, we can use Wilcoxon rank-sum test which relaxes on normality assumption.

### Wilcoxon rank-sum test

**Hypothesis**
$H_0: \mu_x = \mu_y$ vs $H_1: \mu_x \neq \mu_y$

**Assumption**
$X_1, ..., X_{n_x}$ and $Y_1, ..., Y_{n_x}$ are iid and follow the same distribution but differ by a shift.

**Test statistics**
$W = R_1+R_2+...+R_{n_x}$. Under $H_0$, $W \sim WRS(n_x, n_y)$ distribution

**Observed test statistics**
$w=r_1+r_2+...+r_n_x=761$

**P-value**

$p\approx 2P(Z\geq |\frac{W-E(W)}{\sqrt{Var(W)}}|) =0.7953$

**Decision**
As the p-value is much more than 0.05, there is insufficient evidence to reject $H_0$.

```{r}
wilcox.test(with_parents$study_time,without_parents$study_time,correct = FALSE,alternative = "two.sided")
```
### Conclusion
Firstly, by looking at the boxplot in data cleaning part, there is no much difference between two plot. And there have similar distribution. Moreover, we assumes the equal variance and normality, pooled two sample t-test is being used. Then we relaxes assumption normality and equal variance. We use wilcoxan test. By these two test, it doesm't found any evidence of difference on study time between these two groups. Therefore, we have insufficent evidence to say there is a difference on study time between these two groups.

## 7: What other questions could you ask? 

### Is handedness independent of wearing glasses?

**Assumption: expected cell counts>=5**
It can be seen that the assumption needed for chi-squared test does not hold, therefore, it is recommended to use Fisher exact test
```{r}
handedglasseschi <- mydata %>%
  select(with_glasses, dominant_hand) %>%
  drop_na() %>%
  group_by(with_glasses, dominant_hand) %>%
  count() %>%
  spread(key = dominant_hand, value = n) %>%
  column_to_rownames(var = "with_glasses")
handedglasseschi

n <- sum(handedglasseschi)
r <- rowSums(handedglasseschi)
c <- colSums(handedglasseschi)
e <- r %*% t(c) / n
paste("The expected cell count assumption is", valid <- all(e >= 5))
fisher.test(handedglasseschi)
```
The p-value is 0.7818 which is quite large comparing to 0.05. Therefore, we have sufficient evidence to claim that wearing glasses is independent of handedness.

#### Data visualisation
```{r Visualisation}
ggplot(data = mydata %>%drop_na() ,
       aes(x = dominant_hand, fill = with_glasses) )+
  geom_bar(position = "fill") +
  labs(x = "Handedness", 
       y = "Proportion", 
       fill = "wearing_glasses",
       title = "Distribution of handedness and gender",
       caption = "Source: Data2002 survey") +
  theme_bw()
```
It can be seen that while there were roughly the same amount of left-handed wearing glasses and without glasses, the right-handed subpopulation tended to be skewed towards wearing glasses and the left-handed subpopulation tended to be skewed towards without glasses.


### Is there any evidence that there is an difference on hours of exercise per week between male and female?

#### Visualisation

```{r}
gender = mydata %>% filter(mydata$gender=="male"||mydata$gender=="female")%>% select(gender,hours_of_exercise_per_week)
ggplot(subset(gender,!is.na(hours_of_exercise_per_week)),aes(x=gender,y=hours_of_exercise_per_week))+
  geom_boxplot()+
  theme_bw()+
  labs(title = "The hours of exercise per week for red meat eaters and non-eaters",
       x="Red meat eater?",
       y="Hours exercise per week")

```


This is a two sample t-test.

**Checking assumption: Equal Variance**
Firstly, looking at the pooled two sample t-test, the assumption here is there have equal variance. By test of equal variance assumption, p-value is less than 0.05. Therefore, we have insufficient evidence to assume equal variance.
```{r  equal variance assumption}
male=gender %>% filter(gender=="male",as.numeric(hours_of_exercise_per_week)) %>% drop_na

sd_male=sd(male$hours_of_exercise_per_week)
female=gender %>% filter(gender=="female",as.numeric(hours_of_exercise_per_week)) %>% drop_na
sd_female=sd(female$hours_of_exercise_per_week)
c((sd_male),(sd_female))
var.test(male$hours_of_exercise_per_week,female$hours_of_exercise_per_week)

```


**Checking assumption: Normality**
Therefore, cosidering the second assumption normality, it is assumed that the distribution of these data is normal. This assumption cen be checked by drawing QQ-plot to see wehther it is approximate straight line. By looking at two diagram, it is obvious that the sample is quite fit with theoretical line. Therefore, it is reasonable to assume hours of exercise is normally distributed. There are also sufficient samples.

```{r}
par(mfrow=c(1,2))
qqnorm(male$hours_of_exercise_per_week)
qqline(male$hours_of_exercise_per_week)
qqnorm(female$hours_of_exercise_per_week)
qqline(female$hours_of_exercise_per_week)
```

**Welch test**
```{r}
t.test(male$hours_of_exercise_per_week,female$hours_of_exercise_per_week,alternative = "two.sided",correct=FALSE)
```

Since the equal variance does not hold in our case,but normality is still hold, therefore, we use Welch test which assumes normality but relaxes the assumption of equal variance. 


## Conclusion
In conclusion, we found the following results for our sample of DATA2X02 from the survey:
  1: This is not an random sample. More active students have more probabilities to fill out the survey.
  2: The data is likely to suffers from selection bias and measurement bias
  3: The study time, exercise hours and height are likely to suffer from these bias
  4: We con't find evidence that read meat eaters do exercise more than non-eaters
  5: There is no evidence that people who join more club tend to do exercise different amount of time than those who join less club
  6: There is no evidence that people who live with parents tend to study different amount of time than those who live without parents
  7: Handedness is independent of wearing glasses
  8: We do not found evidence that male spend less study time than female.


## Reference 

### Data source:
https://docs.google.com/spreadsheets/d/1hNeBWmVXTLyUwl6b9yTnfPn2jfbQuBdPJuhJu-FZJSo/export?gid=690048681&format=csv

### Package used:

readr: https://github.com/tidyverse/readr

Tidyverse: https://www.tidyverse.org
  
Dplyr: https://cran.r-project.org/web/packages/dplyr/vignettes/dplyr.html
  
Janitor: https://cran.r-project.org/web/packages/janitor/index.html
  
Ggplot2: https://ggplot2.tidyverse.org/
  
Lubridate: https://www.rdocumentation.org/packages/lubridate/versions/1.7.4
  
kableExtra: https://cran.r-project.org/web/packages/kableExtra/index.html
  
Forcats: https://cran.r-project.org/web/packages/forcats/index.html
  
GenderRcode: https://github.com/ropenscilabs/gendercoder
